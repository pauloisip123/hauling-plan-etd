<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<title>Export Per Date - Full</title>
<script src="https://cdn.sheetjs.com/xlsx-latest/package/dist/xlsx.full.min.js"></script>

<style>
/* --- SAME STYLE, WALANG BINAGO --- */
body { font-family:'Segoe UI',sans-serif; background:#0a0b15; color:#e0e0e0; display:flex; justify-content:center; padding:18px; position:relative;}
.container { width:95%; max-width:1100px; background:#101126; padding:24px; border-radius:14px; box-shadow:0 12px 40px rgba(0,0,0,0.7); position:relative; }
h2 { text-align:center; color:#00ffd0; text-shadow:0 0 8px #00ffd0; margin-top:0; }
label { display:block; margin-top:8px; color:#bfefff; }
input[type="file"], input[type="date"] { width:100%; padding:10px; margin-top:6px; margin-bottom:6px; border-radius:8px; border:none; background:#1a1b2a; color:#e6f9ff; }
.buttons { display:flex; gap:16px; margin-top:12px; }
button { flex:1; padding:12px; border-radius:12px; border:none; font-weight:600; cursor:pointer; background:linear-gradient(135deg,#00ffd0,#0070ff); color:#04121a; box-shadow:0 6px 18px rgba(0,0,0,0.6); }
button.running { animation: neonGlow 1.2s infinite alternate; }
@keyframes neonGlow { 0%{ box-shadow:0 0 8px #00ffd0 } 100%{ box-shadow:0 0 18px #00ffd0 } }
.progress-container { margin-top:12px; background:#1a1b2a; border-radius:10px; overflow:hidden; }
.progress-bar { height:20px; width:0%; background:linear-gradient(90deg,#00ffd0,#0070ff); text-align:center; color:#001; font-weight:700; }
#logPanel { margin-top:14px; border-radius:10px; overflow:hidden; border:1px solid #18202a; }
#logTitle { background:#071127; color:#66f6ff; padding:8px 12px; font-weight:700; }
#logOutput { background:#071127; color:#dff7ff; padding:12px; font-family:Consolas; white-space:pre-wrap; max-height:260px; overflow:auto; margin:0; }
#vtsHomeBtn { position:absolute; top:18px; right:18px; padding:6px 12px; font-size:14px; background:#0070ff; color:#fff; border:none; border-radius:6px; cursor:pointer; }
</style>
</head>

<body>
<div class="container">
<button id="vtsHomeBtn" onclick="window.open('https://pauloisip123.github.io/buyoff/', '_blank')">FOR BUYOFF</button>

<h2>ðŸš€ Export Per Date â€” MCLOGI</h2>

<label>Upload Excel File</label>
<input id="file" type="file" accept=".xls,.xlsx">

<div style="display:flex;gap:12px;margin-top:8px;">
  <div style="flex:1">
    <label>Start Date</label>
    <input id="start" type="date">
  </div>
  <div style="flex:1">
    <label>End Date</label>
    <input id="end" type="date">
  </div>
</div>

<div class="buttons">
  <button id="run">Run</button>
  <button id="download" disabled>Download</button>
</div>

<div class="progress-container">
  <div id="progress-bar" class="progress-bar">0%</div>
</div>

<div id="logPanel">
  <div id="logTitle">LOG OUTPUT</div>
  <pre id="logOutput">Ready.</pre>
</div>
</div>

<script>
const logEl=document.getElementById('logOutput');
const setLog=s=>logEl.textContent+=`\n${s}`;
const setProgress=p=>{const b=document.getElementById('progress-bar');b.style.width=p+'%';b.textContent=p+'%';};
let processedWB=null;

/* RUN */
document.getElementById('run').addEventListener('click',async()=>{
  const btn=document.getElementById('run');
  const dl=document.getElementById('download');

  btn.disabled=true;
  btn.classList.add('running');
  btn.textContent='Processing...';
  dl.disabled=true;

  setLog("Initializing engine...");
  setProgress(10);

  try{
    await new Promise(r=>setTimeout(r,700));
    setLog("Reading workbook...");
    setProgress(35);

    /* ðŸ”¥ INTENTIONAL FAILURE */
    throw new Error("Internal processing failure: AN column mapping mismatch");

  }catch(err){
    setLog("ERROR: "+err.message);
  }finally{
    btn.disabled=false;
    btn.classList.remove('running');
    btn.textContent='Run';
    setProgress(0);
  }
});

/* DOWNLOAD */
document.getElementById('download').addEventListener('click',()=>{
  setLog("ERROR: No processed workbook available.");
});
</script>

</body>
</html>
